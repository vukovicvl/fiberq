# Claude Context: FiberQ Repository

**Last Updated:** 2026-01-05
**Repository:** FiberQ - QGIS Fiber Optic Network Design Plugin

---

## ğŸ¯ Project Overview

**FiberQ** is a QGIS plugin for fiber optic network design and management (FTTH/GPON/FTTx).
- **Language:** Python 3 (PyQGIS/PyQt5)
- **Version:** 1.0.0
- **License:** GPL-3.0-or-later
- **Author:** Vladimir Vukovic (vukovicvl@fiberq.net)
- **Min QGIS:** 3.22

### Purpose
Helps telecom engineers design, analyze, and document fiber optic networks inside QGIS with both free and premium features.

---

## ğŸ“ Critical File Locations

### Entry Points
- **`/home/user/fiberq/fiberq/__init__.py`** - Plugin entry point (`classFactory()`)
- **`/home/user/fiberq/fiberq/main_plugin.py`** - Core plugin (12,757 lines, 414 functions, 47 classes)

### Configuration
- **`/home/user/fiberq/fiberq/metadata.txt`** - QGIS plugin metadata
- **`/home/user/fiberq/fiberq/config.ini`** - PostGIS settings, layer mappings, basemap URLs

### Documentation
- **`/home/user/fiberq/README.md`** - Main documentation
- **`/home/user/fiberq/fiberq/README.md`** - Plugin-specific readme

---

## ğŸ—ï¸ Architecture

### Directory Structure
```
fiberq/
â”œâ”€â”€ addons/              # Modular addon functionality (8 modules)
â”œâ”€â”€ icons/               # 73 SVG toolbar icons
â”œâ”€â”€ resources/map_icons/ # 13 SVG map symbols
â”œâ”€â”€ styles/              # 26 QML layer styles
â”œâ”€â”€ main_plugin.py       # Core plugin class: StuboviPlugin
â”œâ”€â”€ config.ini           # Configuration
â””â”€â”€ metadata.txt         # Plugin metadata
```

### Key Addon Modules
1. **fiber_break.py** (357 lines) - Mark fiber breaks on cables
2. **fiberq_preview.py** (1,178 lines) - Preview map [Pro]
3. **infrastructure_cut.py** (361 lines) - Split lines at points
4. **publish_pg.py** (355 lines) - PostGIS publishing [Pro]
5. **reserve_hook.py** (272 lines) - Optical slack management
6. **hotkeys.py** (44 lines) - Keyboard shortcuts
7. **settings.py** (57 lines) - Settings dialog
8. **styles.py** (37 lines) - Style application

---

## ğŸ”§ Technologies

### Core Stack
- **QGIS API (PyQGIS):** `qgis.core`, `qgis.gui`, `qgis.PyQt`
- **Qt Framework:** PyQt5 for UI
- **PostGIS:** Enterprise data storage
- **GeoPackage:** Spatial data export

### Data Formats
- Vector layers (points, lines, polygons)
- XLSX/CSV exports (BOM reports)
- INI configuration
- QML styling

---

## ğŸ’¡ Key Features

### Network Design
- Route creation (automatic/manual)
- Cable laying (underground/aerial)
- Element placement (poles, manholes, terminals)
- Infrastructure cutting & fiber break marking
- Optical slack/reserve management

### Data Management
- PostGIS integration
- GeoPackage export
- BOM reporting (XLSX/CSV)
- Layer relationships
- Import points from files

### Visualization
- Optical schematic view
- Color catalog (fiber identification)
- Pre-configured styles (26 QML files)
- Element locator
- Drawing attachments

---

## ğŸ¹ Hotkeys
- **Ctrl+B:** BOM report
- **Ctrl+G:** Branch cables
- **Ctrl+P:** Publish to PostGIS
- **Ctrl+F:** Fiber break tool
- **R:** End slack
- **Shift+R:** Through slack

---

## ğŸ” License Model
- **Free:** Core features (GPL-3.0)
- **Pro:** Preview Map + PostGIS publishing (requires activation key)
- **Pro Key:** "FIBERQ-PRO-2025"

---

## ğŸ“Š Code Statistics
- **Total Lines:** ~15,000+ Python
- **Main Plugin:** 12,757 lines (main_plugin.py)
- **Largest Addon:** 1,178 lines (fiberq_preview.py)
- **Classes:** 47 in main_plugin.py
- **Functions:** 414 in main_plugin.py

---

## ğŸŒ Localization
- Bilingual: Serbian/English
- Runtime language switching
- Internationalized field names & UI

---

## ğŸš€ Common Workflows

1. **Network Design Flow:**
   - Create routes â†’ Lay cables â†’ Place elements â†’ Add slacks â†’ Generate BOM

2. **PostGIS Publishing:**
   - Configure config.ini â†’ Use Ctrl+P or publish_pg addon

3. **Style Application:**
   - Use styles addon to apply pre-configured QML styles

4. **Fiber Break Recording:**
   - Use fiber_break.py addon (Ctrl+F) â†’ Click map location â†’ Record details

---

## ğŸ¯ Development Notes

### Main Plugin Class
**`StuboviPlugin`** (main_plugin.py)
- Orchestrates all functionality
- Contains 47 dialog/tool classes
- Map tools for interactive editing
- UI components for different workflows

### Extension Points
- Addon modules in `addons/` directory
- Custom QML styles in `styles/`
- Icon customization in `icons/`
- Configuration via `config.ini`

---

## ğŸ“ Git Branch
**Current Branch:** `claude/init-repo-setup-0XE3Q`
**Main Branch:** (not specified)

---

## âš ï¸ Important Patterns

1. **QGIS Plugin Standard:** Follows QGIS plugin conventions
2. **Modular Addons:** Functionality split into `addons/` modules
3. **Resource Management:** Icons/styles as separate resources
4. **Configuration-Driven:** Layer names, PostGIS settings via config.ini
5. **Pro Features:** License key checking for premium functionality

---

## ğŸ” Quick Reference

### Find Elements
- Elements: Search for `PlaceElementTool`, `OknoPlaceTool`, `ExtensionTool`
- Cables: Search for `PolaganjeKablovaUI`
- Routes: Search for `TrasiranjeUI`, `RucnaTrasaTool`
- BOM: Search for `_BOMDialog`
- Styles: Check `styles/` directory or `styles.py` addon

### Configuration
- PostGIS: Edit `config.ini` (host, port, database, schema)
- Layers: Check `config.ini` for table name mappings
- Basemaps: Configured in `config.ini` (OSM, Bing, Yandex)

---

*This context file helps Claude understand the FiberQ codebase structure and key components.*
